
<%doc>

=head1 NAME

/breeders_toolbox/cross/crossing_trial.mas - a mason component to display a crossing trial detail page

=head1


=cut

</%doc>


<%args>
$trial_id
$trial_name
$breeding_program_id
$breeding_program_name
$location_id
$location_name
$year => undef
$trial_type => undef
$planting_date => undef
$harvest_date => undef
$trial_description => undef
$folder_name => undef
$folder_id => undef
</%args>

<style>

@media (min-width: 1200px) {
    .affix {
        top:100px;
        right:0;
        position:fixed;
    }
}

</style>

<& /util/import_javascript.mas, classes => [ 'jquery.iframe-post-form', 'CXGN.Trial' , 'jstree/dist/jstree', 'CXGN.BreedersToolbox.HTMLSelect', 'moment_min', 'daterangepicker' ] &>

<br/>


<& /page/page_title.mas, title=>"Details for ".$trial_name &>

<& /page/detail_page_2_col_section.mas, info_section_collapsed => 0, trial_id => $trial_id, info_section_title => "<h4 style='display:inline'>Crossing Experiment Details</h4>", info_section_subtitle => 'View and edit basic information about the experiment.', buttons_html => '<button class="btn btn-primary btn-sm" id="edit_crossingtrial_details" style="margin:3px">Edit Crossing Experiment Details</button>', icon_class => "glyphicon glyphicon-dashboard", info_section_id => "crossingtrial_details", trial_name => $trial_name, breeding_program_name => $breeding_program_name, location_name => $location_name, year => $year, planting_date => $planting_date, harvest_date => $harvest_date, trial_description => $trial_description, folder_name => $folder_name, folder_id => $folder_id &>


<& /breeders_toolbox/folder/folder_set.mas, project_type => 'Cross', breeding_program_id => $breeding_program_id, breeding_program_name =>$breeding_program_name, trial_id => $trial_id, trial_name =>$trial_name &>
<& /breeders_toolbox/folder/folder_new.mas, project_type => 'Cross',, breeding_program_id => $breeding_program_id, breeding_program_name =>$breeding_program_name &>


<& /util/import_javascript.mas, classes => ['jquery','jquery.dataTables'] &>
<& /util/import_css.mas, paths => ['/documents/inc/datatables/jquery.dataTables.css'] &>

<&| /page/info_section.mas, title => 'Crosses in this trial', collapsible=>1, collapsed=>0 &>
    <div class = "well well-sm">
        <div class = "panel panel-default">
            <div class = "panel-body">
                <div style="overflow:scroll">
                    <table id = "crosses_in_trial" class="table table-hover table-striped">
                        <thead>
                            <tr>
                                <th>Cross Name</th>
                                <th>Cross Type</th>
                                <th>Female Parent</th>
                                <th>Male Parent</th>
                                <th>Female Plot</th>
                                <th>Male Plot</th>
                                <th>Female Plant</th>
                                <th>Male Plant</th>
                            </tr>
                        </thead>
                    </table>
                </div>
            </div>
        </div>
    </div>
 </&>

 <&| /page/info_section.mas, title => 'Crossing Experimental Info', collapsible=>1, collapsed=>0 &>
    <div class = "well well-sm">
        <div class = "panel panel-default">
            <div class = "panel-body">
                <div style="overflow:scroll">
                <table id = "cross_properties_trial" class="table table-hover table-striped">
                    <thead>
                        <tr>
                            <th>Cross Name</th>
% my $cross_properties = $c->config->{cross_properties};
% my @column_header = split ',',$cross_properties;
% foreach my $column_header(@column_header){
                            <th><%$column_header%></th>
%}
                        </tr>
                    </thead>
                </table>
                </div>
            </div>
        </div>
    </div>
</&>

<&| /page/info_section.mas, title => 'Progeny Info', collapsible=>1, collapsed=>0 &>
    <div class = "well well-sm">
        <div class = "panel panel-default">
            <div class = "panel-body">
                <table id = "cross_progenies_trial" class="table table-hover table-striped">
                    <thead>
                        <tr>
                            <th>Cross Name</th>
                            <th>Number of Progenies</th>
                        </tr>
                    </thead>
                </table>
            </div>
        </div>
    </div>
</&>

<div class="row">
    <div class="col-sm-12">
        <div class="well">
            <div class="row">
                <div class="col-sm-1">
                    <span style="font-size:3.5em;" class="glyphicon glyphicon-link"></span>
                </div>
                <div class="col-sm-11">
                    <h4>Trial Linkage</h4>

                    <&| /page/info_section.mas, title => 'Field Trial to Crossing Trial Linkage', id => 'crossing_trial_from_field_trial_section', collapsible => 1, collapsed => 1 &>
                        <& /breeders_toolbox/trial/crossing_trial_from_field_trial_linkage.mas, trial_id => $trial_id, trial_type => 'crossing_trial' &>
                    </&>
                </div>
            </div>
        </div>
    </div>
</div>


<script>

jQuery(document).ready(function(){

    jQuery('#crosses_in_trial').DataTable({
        'ajax':'/ajax/breeders/trial/'+ <% $trial_id %> + '/crosses_in_trial',
    });

    jQuery('#cross_properties_trial').DataTable({
        'ajax':'/ajax/breeders/trial/'+ <% $trial_id %> + '/cross_properties_trial',
    });

    jQuery('#cross_progenies_trial').DataTable({
        'ajax':'/ajax/breeders/trial/'+ <% $trial_id %> + '/cross_progenies_trial',
    });

});

</script>
