<%args>
</%args>

<table class="table table-hover table-bordered" id="identifier_generator_list_table">
    <thead>
        <tr>
            <th>Name</th>
            <th>Description</th>
            <th>Prefix</th>
            <th>Number of Digits</th>
            <th>Current Number</th>
            <th>Next Identifier</th>
            <th>Download Next Identifiers</th>
        </tr>
    </thead>
</table>

<script>

jQuery(document).ready(function(){
    var identifier_generation_list_table = jQuery('#identifier_generator_list_table').DataTable({
        ajax : '/ajax/breeders/identifier_generation_list'
    });

    jQuery(document).on('click', 'button[name="identifier_generation_download"]', function(){
        var list_id = jQuery(this).data('list_id');
        var next_number = jQuery('#identifier_generation_next_numbers_'+list_id).val();
        jQuery.ajax({
            url : '/ajax/breeders/identifier_generation_download',
            data : {
                'list_id':list_id,
                'next_number':next_number
            },
            success: function(response){
                console.log(response);
                if(response.error){
                    alert(response.error);
                }
                if(response.success){
                    window.location.href = "/download/"+response.filename;
                    identifier_generation_list_table.ajax.reload();
                }
            },
            error: function(response){
                alert('Error downloading new identifiers!');
            }
        });
    });
});

</script>