
<%args>
$trial_id
</%args>

<& /util/import_javascript.mas, classes => [  ] &>


<div id="trial_plots_html">
</div>

<script>

jQuery(document).ready(function () {

    jQuery('#trial_plots_onswitch').one("click", function() {

	jQuery.ajax ( {
            url : '/ajax/breeders/trial/'+<% $trial_id %>+'/plots',
	    beforeSend: function() {
		jQuery("#working_modal").modal("show");
	    },
	    success: function(response){
	        //console.log(response);
		jQuery("#working_modal").modal("hide");
		var trial_plots_html = "<table class='table table-hover table-condensed table-bordered' id='trial_plots_table'><thead><tr><th>Name</th></tr></thead><tbody>";
		for (i=0; i<response.plots[0].length; i++) {
		    trial_plots_html = trial_plots_html + "<tr><td>"+ response.plots[0][i] + "</td></tr>";
		}
		trial_plots_html = trial_plots_html + "</tbody></table>";
		jQuery('#trial_plots_html').empty();
		jQuery('#trial_plots_html').html(trial_plots_html);
        enable_plots_datatable();
	    },
	    error: function(response){
	        jQuery("#working_modal").modal("hide");
		alert("Error retrieving plots.");
	    }
	});
    });

});

function enable_plots_datatable() {
    jQuery('#trial_plots_table').DataTable();
}

</script>
