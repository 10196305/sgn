<%args>
    $children
    $parents
    $title => 'Related Features'
</%args>
<%perl>

sub related_stats {
    my ($features) = @_;
    my $stats = { };
    my $total = scalar @$features;
    for my $f (@$features) {
            $stats->{$f->type->name}++;
    }
    my $data = [ ];
    for my $k (sort keys %$stats) {
        push @$data, [ $k => $stats->{$k} ];
    }
    push @$data, [ "Total" => $total ];
    return $data;
}
</%perl>
<&| /page/info_section.mas,
    title => $title,
    collapsible => 1,
&>
% my $c = 0;
% for my $parent (@$parents) {
Parent Feature:
    <& /feature/link.mas, feature => $parent, &>
    is a <% $parent->type->name %><br>

% last if ++$c > 10;
% }
% $c = 0;
% for my $child (@$children) {
Child Feature:
    <& /feature/link.mas, feature => $child, &>
is a <% $child->type->name %><br>
% last if ++$c > 10;
% }
%if (@$parents) {
<& /page/columnar_table.mas,
    headings => [ "Parent Feature Type", "Number"  ],
    data     => related_stats($parents),
&>
%}
%if (@$children) {
<& /page/columnar_table.as,
    headings => [ "Child Feature Type", "Number" ],
    data     => related_stats($children),
&>
% }
</&>
