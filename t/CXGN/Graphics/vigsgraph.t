
use strict;

use Test::More qw | no_plan |;

use CXGN::Graphics::VigsGraph;

my $vg = CXGN::Graphics::VigsGraph->new();

$vg->bwafile('t/data/vigstool/bwafile');

#$vg->seq_window_size(300);

$vg->query_seq(<<SEQ);
GTGGCTTAGTAGTTTGTAGGAGTAGGAATAGTCTTTTCTTGATCTGAGGGGTTTTTGGTT
TGGTTTTCCTGAATCAAGTCACTTGTGGTTGGCTTGTAACTTGTAAAGATTGAATCTTTA
TACATTTTTTCATCTGGGGTTGGCTTATATTTTGTGAAGATTGAATCTTTATAGGAATTT
TCATCTGGGGTTGGCTTATGTTTTGTGAAGATTGGATCTTTATAGGATTTACTACCTGGG
GTGGCCTTATATTTTGTAAAGATTGAAGCTTTATTGGATTTTTTTAAAATCTGGGGTTGG
CTTATGTTTTGTGTAGAGTTGTATTTGGAATGTTAGATTAGTGAACTATATCTGGGTTTG
GCTGTGAAGATTGAACCTAACTATTATTATCAACAGTAGATTACTTAGGTGTTGTGTGGT
TTGCCGATGGCTCGGTTGATTCTGCCTTGCAAGGGTTCGAGTTTGTCGAAGACGTGTCTC
TTGGGTTTGATCTCCAATAGAGCTTTTCAGGCAAGTTGCCGTGTTACTTCAGTTGGGCGC
TCGAGGGATATCTGCAGATACAAAAAATACCTTACTTCAGAGGTTGCGCATTGGAGGAGG
TGTCAAATCCCGCGTTTTCCATTAGTTCAACCTAGAAGAATTGACCGGAGATTAATCTGT
TCAGTTGCAACTGAACCTCTACCAAAAGAAGTTGAAGAATCCAAGATGGAAGCACCAAAG
GAAATCTTTCTGAAGGATTACAAACAACCTGATTACTATTTTGACACGTTGGATCTGAAA
TTCGCACTGGGTGAGGAAAGTACTATTGTCGCTTCCAAAATTGCTGTCAACCCCAGAGTT
GAAGGTCAGTCTTTCCCACTTGTCCTAGATGGGCGAGATCTGAAGTTGCAATCAGTTAAG
ATCAACGGCAATCCGCTGAAGGAGGAAGATTTCCTCGTGGACTCGCGCCACCTGACTCTG
AAATCCCCTCCAAGTAGCAAATTCACCTTGGAGATTGTGACAGAAATACATCCTCAGAAG
AACACATCCTTAGAGGGTCTTTACAAGTCATCAGGGAATTTCTGCACCCAATGTGAGGCT
GAGGGTTTCCGTAAGATTACGTTCTATCAGGATCGCCCTGACATTATGGCAAAATACACT
TGTCGCATAGAGGCAGACAAATCCTTGTATCCTGTATTGTTGTCAAATGGAAACCTTATA
GAGCAAGGGGATCTGGAGGGAGGAAAGCATTATACTCTTTGGGAGGATCCTTTCAAGAAG
CCCAGTTATCTTTTTGCATTGGTTGCTGGTCAGTTGGTGAGCAGAGATGACACATTTACA
ACCTGTTCAGGCCGTAAGGTCTCCCTTAGAATCTGGACCCCTGCACAAGATCTGCCCAAG
ACAGAACATGCCATGTATTCTCTCAAGGCAGCTATGAAGTGGGATGAAGATGTTTTCGGG
CGGGAGTATGACCTGGATCTTTTTAATATTGTTGCTGTTCCAGATTTTAACATGGGAGCA
ATGGAAAACAAGAGCTTGAATATATTCAATTCCAAGCTTGTCCTGGCATCCCCAGAAACT
GCAACAGATGCTGATTATGCGGCTATATTGGGTGTGATTGGACATGAGTACTTCCACAAT
TGGACAGGCAACAGAGTTACATGTCGTGACTGGTTCCAGCTCAGTTTAAAGGAAGGACTT
ACTGTTTTCCGTGATCAGGAGTTTTCGTCTGATTTGGGCAGCCGTCCTGTGAAAAGAATT
GCTGATGTCTCAAAGCTTCGAATGTATCAGTTCCCGCAGGATGCTGGTCCAATGGCTCAT
CCTGTAAGGCCTCACTCTTATATAAAGATGGATAACTTCTACACAGTTACGGTATATGAG
AAGGGAGCTGAAGTGGTCAGGATGTACAAAACCTTGTTAGGTAGCCAAGGATTTAGAAAA
GGCACAGATTTATATTTTGAGAGGCATGATGGTCAAGCAGTAACATGTGAAGACTTTTTT
GCTGCCATGCGAGATGCCAACAATGCAGATTTTGCTAATTTCTTGTTATGGTACTCGCAA
GCTGGGACACCTGTAGTGAAGGTTACCACAAATTATAATGCTGAAGGGCGCACTTTCTCC
CTCAAGTTTAGTCAAGAGGTGCCTCCAACCCCCGGCCAGTCTGCAAAAGAACCTATGTTT
ATTCCTGTTGCTGTAGGTCTGCTGGATTCAAGTGGTAAGGACATGCCTCTATCTTCGGTT
CATCATGATGGGAAATTGGAGAGTTTTGCGAGCAGTGGTCAAAACGTATACACCACAGTT
CTCCGCGTAACGAAGAAGGAGGAGGAATTTGTGTTCAATGACGTATCTGAGAGGCCAACA
CCATCGATATTGCGAGGATTCAGTGCTCCCATCAGGCTTGAGTCTGATCTCACTGATAGT
GATCTTCTTTTCCTTCTTGCTCATGATTCTGATGAGTTTAACCGGTGGGAGGCGGGACAA
GTGTTGGCAAGGAAGTTGATGCTCAGTCTGGTAGCTGATTTCCAACAGAATAAGGCTTTG
GTTCTTAACCCTCAGTTTTTGCAGGGGATCAAAAGCATACTCACCGACTCAAGCTTGGAT
AAGGAATTCATTGCAAAGGCAATAACTTTGCCTGGTATAGGAGAAATCATGGACATGATG
ACGGTTGCTGATCCAGATGCCGTTCATGCAGTGCGGACTTTCATCAGGAAGCAACTGGCT
TCTGAATTGAAACAAGAGTTCCTTATCACTGCTAAAAACAACAGGAGCTCTGGTGCTTAT
GAGTTTGATCATAACAATATGGCACGTCGTGCTCTTAAAAATATTGCTCTTGCTTATCTT
GGATCACTTGAAAACCCAGAAATCACAGAACTTCTATTGAATGAATACAGAAACGCCACA
AACATGACAGATCAGTTTGCAGCTTTAGTGGCTATCGATCAGCAACCTGCAATTCGTGAA
GAAATTTTGGCTGATTTCTATAACAAGTGGCAGGATGATTACTTGGTTGTGAACAAGTGG
CTTGCTCTTCAAGCTATGTCAGACATGCCTGGTAATGTTGAGAATGTCAAGAAACTTCTA
AACCATACAGCCTTTGACCTATGTAATCCAAATAAGGTTTATTCGTTGATCGGAGGATTT
TGTGGTTCACCTGTCAACTTCCATAGCAAGGATGGCTCCGGCTACAAGTTCTTGGGAGAA
CTAGTGGTGAAGCTTGACAAGATGAATCCACAGGTGGCTTCACGAATGGTTTCAGCGTTC
TCCAGGTGGAAACGTTATGATGAAACAAGACAGAGTCTCGCGAAGGAACAATTGGAGATG
ATCTTGTCTACTGAGGGACTCTCAGAGAATGTGTTTGAAATCGCATCGAAGAGCTTGGCA
GCTTGATTTTTATATTTTTGGTTTCATTTTTCAGTTATTTGAACCGTGCTCTATTTGTTC
CAAAGAGTTTATAATTATGTAATGGTTTCAGTAAACATTAAAACTTAGTTACACTTAGTG
ATATTCATACCTGCGATTTGCATT
SEQ

ok( ref($vg->parse()), "parse result test");

my $matches = $vg->matches();

is(scalar(keys(%$matches)), 57, "match count");


$vg->seq_window_size(200);
my @seqs = $vg->get_best_vigs_seqs(1);

my ($best, $regions) = $vg->get_best_coverage();
print "BEST COVERAGE: $best\n";

$vg->render("/tmp/vigs_test.png", 1);

ok(-s "/tmp/vigs_test.png" > 0, "image file size");









